{% comment %}
  Testimonials Section - Real Users, Real Life-Changing Results
{% endcomment %}

<style>
  .testimonials-section {
    background: #fff;
  }
  .testimonials-header-bg{
    padding: 80px 20px;
    max-width: 1300px;
    margin: 0 auto;
    text-align: center;
  }
  .testimonials-header h2 {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 10px;
    color: #1a1a1a;
  }

  .testimonials-header h3 {
    font-size: 2.5rem;
    font-weight: 700;
    color: #1a1a1a;
  }

  .testimonials-header h3 span {
    text-decoration: underline;
    text-decoration-color: #4a9b9b;
    text-decoration-thickness: 3px;
    text-underline-offset: 5px;
  }

  .testimonials-image-wrapper {
    margin: 40px 0;
  }

  .testimonials-image-wrapper img {
    width: 100%;
    height: auto;
    display: block;
    max-width: 100%;
  }

  .testimonials-list {
    display: flex;
    flex-direction: column;
    gap: 30px;
    margin-top: 50px;
    text-align: left;
    max-width: 900px;
    margin-left: auto;
    margin-right: auto;
  }

  .testimonial-card {
    display: flex;
    gap: 30px;
    align-items: flex-start;
  }

  .testimonial-image {
    flex-shrink: 0;
    width: 240px;
    height: 260px;
    border: 8px solid #f5f5f5;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .testimonial-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .testimonial-content {
    flex: 1;
    padding-top: 10px;
  }

  .verified-badge {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 15px;
  }

  .stars {
    color: #ffa500;
    font-size: 16px;
  }

  .verified-text {
    color: #4a9b9b;
    font-weight: 600;
    font-size: 14px;
  }

  .testimonial-quote {
    font-size: 17px;
    line-height: 1.6;
    color: #555;
    margin-bottom: 25px;
    position: relative;
    padding-left: 40px;
  }

  .testimonial-quote::before {
    content: '"';
    position: absolute;
    left: 0;
    top: -15px;
    font-size: 80px;
    color: #ccc;
    font-family: Georgia, serif;
    line-height: 1;
  }

  .testimonial-author {
    display: flex;
    align-items: center;
    gap: 15px;
  }

  .author-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: #e0e0e0;
    overflow: hidden;
  }

  .author-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .author-info h4 {
    margin: 0;
    font-size: 16px;
    font-weight: 600;
    color: #1a1a1a;
  }

  .author-location {
    font-size: 14px;
    color: #666;
  }

  .purchase-info {
    color: #4a9b9b;
    font-weight: 600;
    font-size: 14px;
    margin-top: 5px;
  }

  .testimonial-cta-wrapper {
    margin-top: 40px;
  }

  .cta-button {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    background: linear-gradient(115deg, #c740a3, #9140c7);
    color: #fff;
    padding: 15px 80px;
    font-size: 18px;
    font-weight: 600;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    transition: background 0.3s ease;
    text-decoration: none;
    font-family: inherit;
    justify-content: center;
    width: 40%;
  }

  .cta-button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    background: #ccc;
  }

  .cta-button:hover:not(:disabled) {
    background: linear-gradient(115deg, #c740a3, #9140c7);
  }

  @media (max-width: 768px) {
    .testimonials-header h2,
    .testimonials-header h3 {
      font-size: 1.8rem;
    }
 .testimonials-header-bg{
    padding: 40px 20px;
  }
    .testimonials-section {
      padding: 0px 15px;
    }

    .testimonial-card {
      flex-direction: column;
    }
 .cta-button {
    width: 100%;
  }

    .testimonial-image {
      width: 100%;
      max-width: 240px;
      margin: 0 auto;
    }
  }
</style>

<section class="testimonials-section">
   <div class="testimonials-header-bg">
  <div class="testimonials-header">
    <h2>{{ section.settings.heading_line_1 }}</h2>
    <h3><span>{{ section.settings.heading_line_2_highlight }}</span> {{ section.settings.heading_line_2_rest }}</h3>
  </div>

  {% if section.settings.testimonials_image %}
    <div class="testimonials-image-wrapper">
      <img 
        src="{{ section.settings.testimonials_image | img_url: 'master' }}" 
        alt="{{ section.settings.image_alt | default: 'Customer testimonials' }}"
        loading="lazy"
      >
    </div>
  {% endif %}

  {% if section.blocks.size > 0 %}
    <div class="testimonials-list">
      {% for block in section.blocks %}
        <div class="testimonial-card" {{ block.shopify_attributes }}>
          {% if block.settings.image %}
            <div class="testimonial-image">
              <img src="{{ block.settings.image | img_url: 'master' }}" alt="{{ block.settings.author_name }}" loading="lazy">
            </div>
          {% endif %}
          
          <div class="testimonial-content">
            <div class="verified-badge">
              <span class="stars">★★★★★</span>
              <span class="verified-text">Verified Purchase</span>
            </div>

            <div class="testimonial-quote">
              {{ block.settings.quote }}
            </div>

            <div class="testimonial-author">
              <div class="author-avatar">
                {% if block.settings.avatar %}
                  <img src="{{ block.settings.avatar | img_url: 'master' }}" alt="{{ block.settings.author_name }}">
                {% else %}
                  <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%23ddd'/%3E%3C/svg%3E" alt="Avatar">
                {% endif %}
              </div>
              <div class="author-info">
                <h4>{{ block.settings.author_name }}</h4>
                <p class="author-location">{{ block.settings.author_location }}</p>
                <p class="purchase-info">{{ block.settings.purchase_info }}</p>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  {% if section.settings.show_cta and section.settings.product != blank %}
    {%- assign selected_product = section.settings.product -%}
    {%- assign current_variant = selected_product.selected_or_first_available_variant -%}
    
    <div class="testimonial-cta-wrapper">
      {%- if current_variant.available -%}
        {%- capture Button -%}
          <button type="button" class="cta-button">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="white">
              <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
            </svg>
            {{ section.settings.cta_text }}
          </button>
        {%- endcapture -%}

        {% render 'product-to-cart', 
            trigger: Button, 
            variant: current_variant
        %}
      {%- else -%}
        <button type="button" class="cta-button" disabled>
          {{ 'products.product.sold_out' | t }}
        </button>
      {%- endif -%}
    </div>
  {% endif %}
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const ctaButtons = document.querySelectorAll('.testimonials-section .cta-button');
    ctaButtons.forEach(function(button) {
      button.addEventListener('click', function() {
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });
    });
  });
</script>

{% schema %}
{
  "name": "Testimonials Section",
  "settings": [
    {
      "type": "text",
      "id": "heading_line_1",
      "label": "Heading Line 1",
      "default": "Real Users."
    },
    {
      "type": "text",
      "id": "heading_line_2_highlight",
      "label": "Heading Line 2 (Highlighted Part)",
      "default": "Real Life-Changing"
    },
    {
      "type": "text",
      "id": "heading_line_2_rest",
      "label": "Heading Line 2 (Rest)",
      "default": "Results."
    },
    {
      "type": "image_picker",
      "id": "testimonials_image",
      "label": "Testimonials Image"
    },
    {
      "type": "text",
      "id": "image_alt",
      "label": "Image Alt Text",
      "default": "Customer testimonials"
    },
    {
      "type": "checkbox",
      "id": "show_cta",
      "label": "Show CTA Button",
      "default": true
    },
    {
      "type": "text",
      "id": "cta_text",
      "label": "CTA Button Text",
      "default": "Add to cart"
    },
    {
      "type": "product",
      "id": "product",
      "label": "Select Product",
      "info": "Choose the product to add to cart when button is clicked"
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Testimonial Image"
        },
        {
          "type": "image_picker",
          "id": "avatar",
          "label": "Author Avatar"
        },
        {
          "type": "textarea",
          "id": "quote",
          "label": "Testimonial Quote",
          "default": "After using the Knee Relief Massager, my knee pain has significantly decreased, and I can walk much longer distances. It's a game-changer for me!"
        },
        {
          "type": "text",
          "id": "author_name",
          "label": "Author Name",
          "default": "James T."
        },
        {
          "type": "text",
          "id": "author_location",
          "label": "Author Location",
          "default": "Birmingham"
        },
        {
          "type": "text",
          "id": "purchase_info",
          "label": "Purchase Info",
          "default": "Purchased 1 pair"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Testimonials Section",
      "blocks": [
        {
          "type": "testimonial"
        },
        {
          "type": "testimonial"
        },
        {
          "type": "testimonial"
        }
      ]
    }
  ]
}
{% endschema %}