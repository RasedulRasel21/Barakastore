{% comment %}
  Blog Carousel Section
  Save this as sections/blog-carousel.liquid
{% endcomment %}

<style>
  .bc-section-wrapper-v1 {
    padding: 60px 20px;
    background-color: #f5f5f5;
  }

  .bc-main-container-v1 {
    max-width: 1400px;
    margin: 0 auto;
  }

  .bc-header-content-v1 {
    text-align: center;
    margin-bottom: 50px;
  }

  .bc-main-heading-v1 {
    font-size: 48px;
    font-weight: 700;
    margin: 0 0 16px 0;
    color: #2d2d2d;
  }

  .bc-sub-heading-v1 {
    font-size: 18px;
    color: #666;
    max-width: 700px;
    margin: 0 auto;
    line-height: 1.6;
  }

  .bc-slider-wrapper-v1 {
    position: relative;
    overflow: hidden;
    padding: 0 60px;
  }

  .bc-slides-track-v1 {
    display: flex;
    gap: 30px;
    transition: transform 0.5s ease;
  }

  .bc-article-card-v1 {
    min-width: calc(33.333% - 20px);
    background: white;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .bc-article-card-v1:hover {
    transform: translateY(-8px);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
  }

  .bc-card-thumbnail-v1 {
    width: 100%;
    height: 280px;
    object-fit: cover;
  }

  .bc-card-text-content-v1 {
    padding: 30px;
  }

  .bc-card-heading-v1 {
    font-size: 22px;
    font-weight: 600;
    margin: 0 0 16px 0;
    color: #2d2d2d;
    line-height: 1.4;
  }

  .bc-card-description-v1 {
    font-size: 15px;
    color: #666;
    line-height: 1.6;
    margin: 0 0 24px 0;
  }

  .bc-card-cta-link-v1 {
    display: inline-block;
    padding: 12px 24px;
    background-color: #f0f0f0;
    color: #2d2d2d;
    text-decoration: none;
    border-radius: 8px;
    font-weight: 500;
    transition: background-color 0.3s ease;
  }

  .bc-card-cta-link-v1:hover {
    background-color: #e0e0e0;
  }

  .bc-nav-button-v1 {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: white;
    border: none;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    transition: all 0.3s ease;
    z-index: 10;
  }

  .bc-nav-button-v1:hover {
    background-color: #2d2d2d;
    color: white;
  }

  .bc-nav-prev-button-v1 {
    left: 0;
  }

  .bc-nav-next-button-v1 {
    right: 0;
  }

  .bc-pagination-dots-v1 {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin-top: 40px;
  }

  .bc-dot-indicator-v1 {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background-color: #d0d0d0;
    border: none;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  .bc-dot-indicator-v1.bc-dot-active-v1 {
    background-color: #2d9d9d;
  }

  @media (max-width: 1024px) {
    .bc-article-card-v1 {
      min-width: calc(50% - 15px);
    }
  }

  @media (max-width: 768px) {
    .bc-main-heading-v1 {
      font-size: 36px;
    }

    .bc-slider-wrapper-v1 {
      padding: 0 50px;
    }

    .bc-article-card-v1 {
      min-width: 100%;
    }

    .bc-nav-button-v1 {
      width: 40px;
      height: 40px;
    }
  }
</style>

<div class="bc-section-wrapper-v1">
  <div class="bc-main-container-v1">
    <div class="bc-header-content-v1">
      <h2 class="bc-main-heading-v1">{{ section.settings.heading }}</h2>
      <p class="bc-sub-heading-v1">{{ section.settings.subheading }}</p>
    </div>

    <div class="bc-slider-wrapper-v1">
      <button class="bc-nav-button-v1 bc-nav-prev-button-v1" aria-label="Previous">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>

      <div class="bc-slides-track-v1">
        {% for article in blogs[section.settings.blog].articles limit: section.settings.articles_to_show %}
          <div class="bc-article-card-v1">
            {% if article.image %}
              <img 
                src="{{ article.image | img_url: 'master' }}" 
                alt="{{ article.image.alt | escape }}"
                class="bc-card-thumbnail-v1"
                loading="lazy"
              >
            {% else %}
              <div class="bc-card-thumbnail-v1" style="background-color: #e0e0e0;"></div>
            {% endif %}
            
            <div class="bc-card-text-content-v1">
              <h3 class="bc-card-heading-v1">{{ article.title }}</h3>
              <p class="bc-card-description-v1">
                {{ article.excerpt_or_content | strip_html | truncate: 120 }}
              </p>
              <a href="{{ article.url }}" class="bc-card-cta-link-v1">
                {{ section.settings.button_text }}
              </a>
            </div>
          </div>
        {% endfor %}
      </div>

      <button class="bc-nav-button-v1 bc-nav-next-button-v1" aria-label="Next">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>
    </div>

    <div class="bc-pagination-dots-v1"></div>
  </div>
</div>

<script>
  (function() {
    const bcTrackElement = document.querySelector('.bc-slides-track-v1');
    const bcCardElements = document.querySelectorAll('.bc-article-card-v1');
    const bcPrevButton = document.querySelector('.bc-nav-prev-button-v1');
    const bcNextButton = document.querySelector('.bc-nav-next-button-v1');
    const bcDotsWrapper = document.querySelector('.bc-pagination-dots-v1');
    
    let bcCurrentSlideIndex = 0;
    let bcVisibleCardsCount = 3;
    
    function bcUpdateVisibleCards() {
      if (window.innerWidth <= 768) {
        bcVisibleCardsCount = 1;
      } else if (window.innerWidth <= 1024) {
        bcVisibleCardsCount = 2;
      } else {
        bcVisibleCardsCount = 3;
      }
    }
    
    function bcInitializeDots() {
      bcDotsWrapper.innerHTML = '';
      const bcTotalPages = Math.ceil(bcCardElements.length / bcVisibleCardsCount);
      
      for (let i = 0; i < bcTotalPages; i++) {
        const bcDotButton = document.createElement('button');
        bcDotButton.classList.add('bc-dot-indicator-v1');
        bcDotButton.setAttribute('aria-label', `Go to slide ${i + 1}`);
        if (i === 0) bcDotButton.classList.add('bc-dot-active-v1');
        
        bcDotButton.addEventListener('click', () => {
          bcCurrentSlideIndex = i;
          bcUpdateSliderPosition();
        });
        
        bcDotsWrapper.appendChild(bcDotButton);
      }
    }
    
    function bcUpdateSliderPosition() {
      const bcCardWidth = bcCardElements[0].offsetWidth;
      const bcGapSize = 30;
      const bcTranslateAmount = bcCurrentSlideIndex * (bcCardWidth + bcGapSize) * bcVisibleCardsCount;
      bcTrackElement.style.transform = `translateX(-${bcTranslateAmount}px)`;
      
      // Update dot indicators
      document.querySelectorAll('.bc-dot-indicator-v1').forEach((bcDot, bcIndex) => {
        bcDot.classList.toggle('bc-dot-active-v1', bcIndex === bcCurrentSlideIndex);
      });
    }
    
    bcPrevButton.addEventListener('click', () => {
      if (bcCurrentSlideIndex > 0) {
        bcCurrentSlideIndex--;
        bcUpdateSliderPosition();
      }
    });
    
    bcNextButton.addEventListener('click', () => {
      const bcMaxSlides = Math.ceil(bcCardElements.length / bcVisibleCardsCount);
      if (bcCurrentSlideIndex < bcMaxSlides - 1) {
        bcCurrentSlideIndex++;
        bcUpdateSliderPosition();
      }
    });
    
    // Initialize carousel
    bcUpdateVisibleCards();
    bcInitializeDots();
    
    // Handle window resize
    let bcResizeTimeout;
    window.addEventListener('resize', () => {
      clearTimeout(bcResizeTimeout);
      bcResizeTimeout = setTimeout(() => {
        bcUpdateVisibleCards();
        bcCurrentSlideIndex = 0;
        bcInitializeDots();
        bcUpdateSliderPosition();
      }, 250);
    });
  })();
</script>

{% schema %}
{
  "name": "Blog Carousel",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Latest from the blog"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Explore insightful content that keeps you ahead of the curve and connected to the pulse of what's happening."
    },
    {
      "type": "blog",
      "id": "blog",
      "label": "Blog"
    },
    {
      "type": "range",
      "id": "articles_to_show",
      "min": 3,
      "max": 12,
      "step": 1,
      "label": "Number of articles to show",
      "default": 6
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "Read more"
    }
  ],
  "presets": [
    {
      "name": "Blog Carousel"
    }
  ]
}
{% endschema %}